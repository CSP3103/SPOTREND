{% extends "base.html" %}

{% block title %}{{ artista.nombre }} - Spotrend{% endblock %}

{% block content %}
<div class="page-header">
    <h1>
        {% if artista.imagen_url %}
        <img src="{{ artista.imagen_url }}" alt="{{ artista.nombre }}"
             style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-right: 15px;">
        {% else %}
        <i class="fas fa-user-circle fa-2x" style="margin-right: 15px;"></i>
        {% endif %}
        {{ artista.nombre }}
    </h1>
    <div>
        <a href="/artistas/{{ artista.id }}/editar" class="btn btn-warning">
            <i class="fas fa-edit"></i> Editar
        </a>
        <a href="/artistas" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Volver
        </a>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-info-circle"></i> Información del Artista</h2>
            </div>

            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="info-item">
                            <h5><i class="fas fa-user"></i> Nombre</h5>
                            <p class="info-value">{{ artista.nombre }}</p>
                        </div>

                        <div class="info-item">
                            <h5><i class="fas fa-globe"></i> País</h5>
                            <p class="info-value">
                                {% if artista.pais %}
                                <span class="badge badge-success">{{ artista.pais }}</span>
                                {% else %}
                                <span class="text-muted">No especificado</span>
                                {% endif %}
                            </p>
                        </div>

                        <div class="info-item">
                            <h5><i class="fas fa-music"></i> Género Principal</h5>
                            <p class="info-value">
                                {% if artista.genero_principal %}
                                <span class="badge badge-info">{{ artista.genero_principal }}</span>
                                {% else %}
                                <span class="text-muted">No especificado</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="info-item">
                            <h5><i class="fas fa-chart-line"></i> Popularidad</h5>
                            <p class="info-value">
                                <div class="popularity-display">
                                    <div class="popularity-value">{{ artista.popularidad }}%</div>
                                    <div class="progress" style="height: 10px; margin-top: 5px;">
                                        <div class="progress-bar bg-warning"
                                             style="width: {{ artista.popularidad }}%"></div>
                                    </div>
                                    <div class="popularity-labels">
                                        <span>0%</span>
                                        <span>50%</span>
                                        <span>100%</span>
                                    </div>
                                </div>
                            </p>
                        </div>

                        <div class="info-item">
                            <h5><i class="fas fa-calendar"></i> Fecha de Creación</h5>
                            <p class="info-value">{{ artista.creado_en.strftime('%d/%m/%Y %H:%M') }}</p>
                        </div>

                        <div class="info-item">
                            <h5><i class="fas fa-fingerprint"></i> ID</h5>
                            <p class="info-value"><code>{{ artista.id }}</code></p>
                        </div>

                        <div class="info-item">
                            <h5><i class="fas fa-trash"></i> Estado</h5>
                            <p class="info-value">
                                {% if artista.deleted_at %}
                                <span class="badge badge-danger">Eliminado</span>
                                {% else %}
                                <span class="badge badge-success">Activo</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h2><i class="fas fa-chart-bar"></i> Análisis Visual</h2>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-4">
                        <div class="metric-circle">
                            <div class="circle-value">{{ artista.popularidad }}%</div>
                            <div class="circle-label">Popularidad</div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="metric-circle">
                            <div class="circle-value">
                                {% if artista.pais %}✓{% else %}—{% endif %}
                            </div>
                            <div class="circle-label">País</div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="metric-circle">
                            <div class="circle-value">
                                {% if artista.genero_principal %}✓{% else %}—{% endif %}
                            </div>
                            <div class="circle-label">Género</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-rocket"></i> Acciones Rápidas</h2>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="/artistas/{{ artista.id }}/comparar" class="btn btn-spotify btn-block">
                        <i class="fab fa-spotify"></i> Comparar con Spotify
                    </a>

                    <a href="/comparar/artista/{{ artista.id }}" class="btn btn-info btn-block">
                        <i class="fas fa-exchange-alt"></i> Comparación API
                    </a>

                    <a href="/recomendaciones/artista/{{ artista.id }}" class="btn btn-warning btn-block">
                        <i class="fas fa-star"></i> Recomendaciones
                    </a>

                    <a href="/comparacion-local/artistas/{{ artista.id }}/comparar" class="btn btn-secondary btn-block">
                        <i class="fas fa-users"></i> Comparar Localmente
                    </a>

                    <a href="/artistas/{{ artista.id }}/eliminar" class="btn btn-danger btn-block">
                        <i class="fas fa-trash"></i> Eliminar Artista
                    </a>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h2><i class="fas fa-code"></i> Información Técnica</h2>
            </div>
            <div class="card-body">
                <p><strong>Endpoint API:</strong></p>
                <code>GET /artistas/{{ artista.id }}</code>

                <div class="mt-3">
                    <p><strong>JSON Response:</strong></p>
                    <pre style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.9rem;">
{
  "id": {{ artista.id }},
  "nombre": "{{ artista.nombre }}",
  "pais": {{ '"' + artista.pais + '"' if artista.pais else 'null' }},
  "genero_principal": {{ '"' + artista.genero_principal + '"' if artista.genero_principal else 'null' }},
  "popularidad": {{ artista.popularidad }},
  "imagen_url": {{ '"' + artista.imagen_url + '"' if artista.imagen_url else 'null' }},
  "creado_en": "{{ artista.creado_en }}",
  "deleted_at": {{ '"' + artista.deleted_at.strftime('%Y-%m-%d %H:%M:%S') + '"' if artista.deleted_at else 'null' }}
}</pre>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h2><i class="fas fa-history"></i> Historial</h2>
            </div>
            <div class="card-body">
                <p><i class="fas fa-calendar-check"></i> Creado: {{ artista.creado_en.strftime('%d/%m/%Y') }}</p>

                {% if artista.deleted_at %}
                <div class="alert alert-danger">
                    <i class="fas fa-trash"></i> Eliminado: {{ artista.deleted_at.strftime('%d/%m/%Y %H:%M') }}
                    <a href="/artistas/{{ artista.id }}/restaurar" class="btn btn-sm btn-success float-right">
                        <i class="fas fa-trash-restore"></i> Restaurar
                    </a>
                </div>
                {% else %}
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i> Estado: Activo
                </div>
                {% endif %}
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h2><i class="fas fa-cogs"></i> Configuración</h2>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="/artistas/{{ artista.id }}/editar" class="btn btn-outline">
                        <i class="fas fa-edit"></i> Editar Información
                    </a>
                    <a href="/spotify/info/buscar-artista?q={{ artista.nombre }}" class="btn btn-outline">
                        <i class="fab fa-spotify"></i> Buscar en Spotify
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.info-item {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

.info-item:last-child {
    border-bottom: none;
}

.info-item h5 {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.info-item h5 i {
    width: 20px;
    text-align: center;
}

.info-value {
    font-size: 1.1rem;
    font-weight: 500;
    margin: 0;
}

.popularity-display {
    max-width: 200px;
}

.popularity-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: #ff9800;
}

.popularity-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.7rem;
    color: #999;
    margin-top: 3px;
}

.metric-circle {
    padding: 20px;
    border: 2px solid #1DB954;
    border-radius: 50%;
    width: 120px;
    height: 120px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
}

.circle-value {
    font-size: 2rem;
    font-weight: bold;
    color: #1DB954;
}

.circle-label {
    font-size: 0.9rem;
    color: #666;
    margin-top: 5px;
}

.d-grid {
    display: grid;
}

.btn-spotify {
    background: #1DB954;
    color: white;
    border: none;
}

.btn-spotify:hover {
    background: #1AA34A;
    color: white;
}

.btn-outline {
    background: transparent;
    border: 2px solid #1DB954;
    color: #1DB954;
}

.btn-outline:hover {
    background: #1DB954;
    color: white;
}
</style>
{% endblock %}